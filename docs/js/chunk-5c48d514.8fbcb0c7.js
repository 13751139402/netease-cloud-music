(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c48d514"],{1146:function(t,e,i){},"230c":function(t,e,i){"use strict";var n=i("6d83"),a=i.n(n);a.a},"4c1a":function(t,e,i){"use strict";i.r(e);var n,a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("main",{attrs:{id:"scroll"}},[i("figure",{staticClass:"title",on:{click:t.back}},[i("img",{staticClass:"titleImg",attrs:{src:t.commentData.pic+"?param=80y80"}}),i("p",{staticClass:"titileMain"},[i("span",[t._v(t._s(t.commentData.name))]),i("router-link",{attrs:{to:""}},[t._v(t._s(t.artists))])],1),i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("van-icon",{attrs:{name:"arrow"}})],1)]),t.hotComments.length?i("comments",{attrs:{data:t.hotComments,title:"精彩评论"}},[i("span",{staticStyle:{display:"inline-block"},attrs:{slot:"foot"},slot:"foot"},[i("div",{staticClass:"hotComm",on:{click:t.linkHotComm}},[i("span",[t._v("全部精彩评论")]),i("van-icon",{attrs:{name:"arrow"}})],1)])]):t._e(),i("comments",{ref:"musicComm",staticStyle:{"margin-bottom":"6.3vh"},attrs:{data:t.musicComment,title:"最新评论"},on:{commLoad:t.selectMusicComment}}),i("footer",{staticClass:"field"},[i("van-field",{attrs:{placeholder:"这一次也许就是你上热评了"},model:{value:t.commValue,callback:function(e){t.commValue=e},expression:"commValue"}}),i("van-icon",{staticStyle:{"margin-right":"5px"},attrs:{name:"close"}}),i("van-icon",{attrs:{name:"smile-o"}}),i("div",{staticClass:"submit",class:{commFont:t.isCommFont},on:{click:function(e){return t.submitComm(1)}}},[t._v("发送")])],1)],1)},s=[],o=(i("e7e5"),i("d399")),c=i("75fc"),r=i("bd86"),l=(i("be7f"),i("565f")),m=(i("c3a6"),i("ad06")),u=i("652a"),h={0:"music",2:"playlist"},d={data:function(){return{hotComments:[],musicComment:[],commPage:0,total:0,commValue:""}},components:(n={comments:u["a"]},Object(r["a"])(n,m["a"].name,m["a"]),Object(r["a"])(n,l["a"].name,l["a"]),n),computed:{commentData:function(){return this.$store.state.commentData},isCommFont:function(){return""!=this.commValue},artists:function(){return!(!this.commentData||!this.commentData.artists)&&this.commentData.artists.reduce(function(t,e){return t.push(e.name),t},[]).join("/")}},methods:{back:function(){this.$parent.isError=!1,this.$router.push("/music")},hotComment:function(){var t=this;return this.$http.get("comment/hot?id=".concat(this.commentData.id,"&type=").concat(this.commentData.type,"&limit=15")).then(function(e){t.hotComments=e.data.hotComments}).catch(function(){})},selectMusicComment:function(){var t=this;return this.$http.get("/comment/".concat(h[this.commentData.type],"?id=").concat(this.commentData.id,"&limit=15&offset=").concat(15*this.commPage,"&before=0")).then(function(e){var i;(i=t.musicComment).push.apply(i,Object(c["a"])(e.data.comments)),t.commPage++,t.$refs.musicComm.loading=!1,t.hotComments.length>=t.total&&(t.$refs.musicComm.finished=!0)}).catch(function(e){throw t.$parent.isError=!0,new Error(e)})},selectTotal:function(){var t=this;return this.$http.get("/comment/".concat(h[this.commentData.type],"?id=").concat(this.commentData.id,"&limit=0&before=0")).then(function(e){var i=e.data.total;t.total=i,t.$parent.title="评论(".concat(e.data.total,")")}).catch(function(t){throw new Error(t)})},linkHotComm:function(){this.$router.push("hot")},init:function(){var t=this;this.$http.all([this.selectTotal(),this.hotComment(),this.selectMusicComment()]).then(function(){t.$parent.loadType=!1})},submitComm:function(t){var e=this;this.isCommFont&&this.$http.get("/comment?t=".concat(t,"&type=").concat(this.commentData.type,"&id=").concat(this.commentData.id,"&content=").concat(this.commValue)).then(function(t){e.musicComment.unshift(t.data.comment),e.commValue="",Object(o["a"])({type:"success",message:"评论成功",duration:1e3})}).catch(function(t){throw Object(o["a"])({type:"faill",message:"评论失败",duration:1e3}),new Error(t)})}},watch:{commentData:function(){this.$parent.loadType=!0,Object.assign(this.$data,this.$options.data()),this.init()}},mounted:function(){this.init()}},f=d,p=(i("94f2"),i("2877")),b=Object(p["a"])(f,a,s,!1,null,"529b126e",null);e["default"]=b.exports},"565f":function(t,e,i){"use strict";var n=i("2638"),a=i.n(n),s=i("c31d"),o=i("ad06"),c=i("7744"),r=i("dfaf"),l=i("1325"),m=i("a142");function u(){return!m["d"]&&/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase())}var h=i("a8c1"),d=u();function f(){d&&Object(h["e"])(Object(h["b"])())}var p=i("d282"),b=i("ea8e"),g=Object(p["a"])("field"),v=g[0],C=g[1];e["a"]=v({inheritAttrs:!1,props:Object(s["a"])({},r["a"],{error:Boolean,readonly:Boolean,autosize:[Boolean,Object],leftIcon:String,rightIcon:String,clearable:Boolean,labelClass:null,labelWidth:[Number,String],labelAlign:String,inputAlign:String,errorMessage:String,errorMessageAlign:String,type:{type:String,default:"text"}}),data:function(){return{focused:!1}},watch:{value:function(){this.$nextTick(this.adjustSize)}},mounted:function(){this.format(),this.$nextTick(this.adjustSize)},computed:{showClear:function(){return this.clearable&&this.focused&&""!==this.value&&Object(m["b"])(this.value)&&!this.readonly},listeners:function(){var t=Object(s["a"])({},this.$listeners,{input:this.onInput,keypress:this.onKeypress,focus:this.onFocus,blur:this.onBlur});return delete t.click,t},labelStyle:function(){var t=this.labelWidth;if(t)return{width:Object(b["a"])(t)}}},methods:{focus:function(){this.$refs.input&&this.$refs.input.focus()},blur:function(){this.$refs.input&&this.$refs.input.blur()},format:function(t){if(void 0===t&&(t=this.$refs.input),t){var e=t,i=e.value,n=this.$attrs.maxlength;return"number"===this.type&&Object(m["b"])(n)&&i.length>n&&(i=i.slice(0,n),t.value=i),i}},onInput:function(t){t.target.composing||this.$emit("input",this.format(t.target))},onFocus:function(t){this.focused=!0,this.$emit("focus",t),this.readonly&&this.blur()},onBlur:function(t){this.focused=!1,this.$emit("blur",t),f()},onClick:function(t){this.$emit("click",t)},onClickLeftIcon:function(t){this.$emit("click-left-icon",t)},onClickRightIcon:function(t){this.$emit("click-right-icon",t)},onClear:function(t){Object(l["c"])(t),this.$emit("input",""),this.$emit("clear",t)},onKeypress:function(t){if("number"===this.type){var e=t.keyCode,i=-1===String(this.value).indexOf("."),n=e>=48&&e<=57||46===e&&i||45===e;n||Object(l["c"])(t)}"search"===this.type&&13===t.keyCode&&this.blur(),this.$emit("keypress",t)},adjustSize:function(){var t=this.$refs.input;if("textarea"===this.type&&this.autosize&&t){t.style.height="auto";var e=t.scrollHeight;if(Object(m["c"])(this.autosize)){var i=this.autosize,n=i.maxHeight,a=i.minHeight;n&&(e=Math.min(e,n)),a&&(e=Math.max(e,a))}e&&(t.style.height=e+"px")}},renderInput:function(){var t=this.$createElement,e=this.slots("input");if(e)return t("div",{class:C("control",this.inputAlign)},[e]);var i={ref:"input",class:C("control",this.inputAlign),domProps:{value:this.value},attrs:Object(s["a"])({},this.$attrs,{readonly:this.readonly}),on:this.listeners,directives:[{name:"model",value:this.value}]};return"textarea"===this.type?t("textarea",a()([{},i])):t("input",a()([{attrs:{type:this.type}},i]))},renderLeftIcon:function(){var t=this.$createElement,e=this.slots("left-icon")||this.leftIcon;if(e)return t("div",{class:C("left-icon"),on:{click:this.onClickLeftIcon}},[this.slots("left-icon")||t(o["a"],{attrs:{name:this.leftIcon}})])},renderRightIcon:function(){var t=this.$createElement,e=this.slots,i=e("right-icon")||this.rightIcon;if(i)return t("div",{class:C("right-icon"),on:{click:this.onClickRightIcon}},[e("right-icon")||t(o["a"],{attrs:{name:this.rightIcon}})])}},render:function(){var t,e=arguments[0],i=this.slots,n=this.labelAlign,a={icon:this.renderLeftIcon};return i("label")&&(a.title=function(){return i("label")}),e(c["a"],{attrs:{icon:this.leftIcon,size:this.size,title:this.label,center:this.center,border:this.border,isLink:this.isLink,required:this.required,clickable:this.clickable,titleStyle:this.labelStyle,titleClass:[C("label",n),this.labelClass],arrowDirection:this.arrowDirection},class:C((t={error:this.error,disabled:this.$attrs.disabled},t["label-"+n]=n,t["min-height"]="textarea"===this.type&&!this.autosize,t)),scopedSlots:a,on:{click:this.onClick}},[e("div",{class:C("body")},[this.renderInput(),this.showClear&&e(o["a"],{attrs:{name:"clear"},class:C("clear"),on:{touchstart:this.onClear}}),this.renderRightIcon(),i("button")&&e("div",{class:C("button")},[i("button")])]),this.errorMessage&&e("div",{class:C("error-message",this.errorMessageAlign)},[this.errorMessage])])}})},"652a":function(t,e,i){"use strict";var n,a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{appear:"",name:"van-fade"}},[i("section",[i("head",{class:{height:t.title1}},[t._t("title",[i("span",[t._v(t._s(t.title1))])])],2),i("main",[i("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!1,error:t.error,"error-text":"请求失败，点击重新加载"},on:{load:t.onLoad,"update:error":function(e){t.error=e}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.data1,function(e,n){return i("figure",{key:e.commentId,staticClass:"commItem"},[i("head",{staticClass:"commImgContainer"},[i("img",{staticClass:"commImg",attrs:{src:e.user.avatarUrl+"?param=50y50"}})]),i("main",{staticClass:"commMain"},[i("div",{staticClass:"commHead"},[i("figcaption",{staticClass:"commTitle"},[i("span",{staticClass:"commName"},[t._v(t._s(e.user.nickname))]),i("span",{directives:[{name:"time",rawName:"v-time",value:e.time,expression:"item.time"}],staticClass:"commTime"})]),i("div",{staticClass:"commLike",class:{color:e.liked},on:{click:function(e){return t.like(n)}}},[e.likedCountMap?i("span",{staticClass:"commLikeNum"},[t._v(t._s(e.likedCountMap))]):t._e(),e.liked?i("van-icon",{attrs:{name:"good-job"}}):i("van-icon",{attrs:{name:"good-job-o"}})],1)]),i("div",{staticClass:"text",domProps:{innerHTML:t._s(e.content)}})])])}),t._t("foot",null,{slot:"loading"})],2)],1)])])},s=[],o=(i("28a5"),i("ac6a"),i("bd86")),c=(i("2994"),i("2bdd")),r=(i("c3a6"),i("ad06")),l=(i("c5f6"),i("6f2e")),m={props:{data:Array,title:String,total:{type:Number,default:0}},components:(n={},Object(o["a"])(n,r["a"].name,r["a"]),Object(o["a"])(n,c["a"].name,c["a"]),n),data:function(){return{title1:this.title,loading:!1,finished:!1,error:!1,total1:this.total}},computed:{playData:function(){return this.$store.state.playData},data1:function(){return this.data&&this.data.forEach(function(t){var e=t.likedCount;if(e>1e5){var i=Math.floor(e/1e4),n=String(e%1e4).slice(0,1);t.likedCountMap="0"===n?"".concat(i,"万"):"".concat(i,".").concat(n,"万")}else t.likedCountMap=e;t.content=t.content.split("\n").join("<br />")}),this.data}},mixins:[l["a"]],methods:{onLoad:function(){this.error=!1,this.$emit("commLoad")},like:function(t){var e=this,i=this.data[t],n=i.commentId,a=i.liked,s=this.playData,o=s.id,c=s.type;this.$http.get("/comment/like?id=".concat(o,"&cid=").concat(n,"&t=").concat(a?0:1,"&type=").concat(c)).then(function(){i.liked=!a,e.likedCountMap=i.liked?i.likedCount++:i.likedCount--}).catch(function(t){throw new Error(t)})}}},u=m,h=(i("230c"),i("2877")),d=Object(h["a"])(u,a,s,!1,null,"90a6d392",null);e["a"]=d.exports},"6d83":function(t,e,i){},"94f2":function(t,e,i){"use strict";var n=i("bdb8"),a=i.n(n);a.a},bdb8:function(t,e,i){},be7f:function(t,e,i){"use strict";i("68ef"),i("09fe"),i("1146")}}]);
//# sourceMappingURL=chunk-5c48d514.8fbcb0c7.js.map